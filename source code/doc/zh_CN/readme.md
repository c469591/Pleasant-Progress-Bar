# 悦耳进度条NVDA插件

让NVDA的进度条音效变得更加悦耳动听，支持多种波形和自定义配置。

## 效果试听

传统进度条音效：单调的嘀嘀声→
[点我下载原始进度条录音.wav](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/listen/Original_progress_bar.wav)
悦耳进度条，使用正弦波和余弦淡入淡出效果→
[点我下载悦耳进度条录音.wav](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/listen/Pleasant_progress_bar.wav)


## 下载和GitHub仓库

* 你可以
[点击这里下载最新版本](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/pleasant_progress_bar_V0.1.nvda-addon)
的NVDA插件。
* 你还可以前往我的github仓库页面
[点我前往悦耳进度条的github仓库页面](https://github.com/c469591/Pleasant-Progress-Bar)

## 兼容性

理论上支持2019.3之后的所有版本，但仅在nvda2025.2上进行测试。

## 🚀 功能特色

* 多种波形支持：正弦波、方波、三角波、锯齿波、脉冲波、白噪音
* 智能淡入淡出：余弦和高斯两种平滑算法
* 自定义配置：音量、频率范围完全可调


## ⌨️ 快捷键

* NVDA+Shift+P：切换悦耳进度条功能开关

## 🔧 使用方法


1. 安装插件后重启NVDA
1. 按 `NVDA+Shift+P` 切换开启或停用插件功能。（默认为开启状态）
1. 在任何有进度条的应用程序中体验悦耳的音效
1. 通过NVDA设置面板自定义音效参数

### 设置配置

1. 打开NVDA菜单 → 选项 → 设置
1. 在类别列表中找到「悦耳进度条」
1. 根据个人喜好调整以下设置：
   * 波形类型：选择喜欢的波形（正弦波最柔和，方波最清脆）
   * 淡入淡出算法：余弦（经典）或高斯（更平滑）
   * 音量调整：0.1最小，到1.0最大
   * 波形长度:从40毫秒到100毫秒，默认值为80毫秒，40毫秒的效果最接近原始进度条的风格，
但80毫秒以下的波形长度可能会引入啪啪声，这是32bit音频系统产生的缺陷，目前还没找到可以完全修复的方法
   * 起点频率（低频）：110Hz到300Hz范围
   * 终点频率（高频）：1200Hz到1750Hz范围



## 🛠️ 故障排除

### 当进度条音效没有改变时

1. 检查插件状态
   * 按 `NVDA+Shift+P` 确认插件已开启
   * 听到「开启 悦耳进度条」提示即表示功能已启用
1. 检查音频系统
   * 确保你的电脑音频输出设备正常工作
   * 尝试调高系统音量或NVDA音量
   * 在悦耳进度条设置中将音量调高
1. 重置设置
如果音效出现异常，可以在设置面板中：
   * 将所有设置调回默认值
   * 或移除插件重新安装

### 常见问题解答

Q: 为什么有时音效会延迟？  
A: 这可能是32位系统的音频缓冲导致，插件已进行优化，但某些老旧电脑可能仍有轻微延迟。

Q: 可以同时播放多个进度条音效吗？  
A: 插件设计为单声道播放，同时多个进度条会以最后触发的为准，避免音频混乱。

Q: 音效太大声或太小声怎么办？  
A: 请到设置面板调整音量，或检查系统音频设置。

### 导出日志，让开发者诊断问题

   1. 打开NVDA菜单 → 选项 → 设置 → 常规
   1. 将「日志级别」设为「调试」
   1. 找到一个有进度条的地方，并确认插件为开启状态，
在有进度条的ui等待一段时间，例如30秒，
这样是为了触发插件的捕获逻辑以产生日志
   1. 打开NVDA菜单 → 工具 → 查看日志
   1. 全选复制所有内容并复制，把内容贴到记事本保存，之后把文件发给开发者来诊断


## 🤝 技术支持

如果你遇到问题或有建议，欢迎联系：

* 电子邮件：
c469591@mail.batol.net
* 或前往GitHub仓库提问:
[点我前往悦耳进度条的GitHub仓库](https://github.com/c469591/Pleasant-Progress-Bar)
* 我还有更多原创文章和软件，可以访问我的网站→
[小羔羊分享站](https://lamb.tw/)

## 📋 更新日志

### V0.2


* 设置选项中新增了可控制的波形长度，最短40毫秒，最长100毫秒，40毫秒的效果更接近原始进度条的风格
* 现在用户也可以在nvda的快捷键设置中，修改启用和禁用悦耳进度条的快捷键


### V0.1

* 首次发布
* 支持多种波形类型
* 音频缓存系统
* 完整的设置面板
* 余弦和高斯淡入淡出算法


## 📝 授权条款

本插件采用 [GPL v3] 发布，详细条款请参阅 LICENSE 文件。

---

享受更悦耳的进度条体验！ 🎵
