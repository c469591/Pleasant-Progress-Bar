# 悅耳進度條NVDA插件

讓NVDA的進度條音效變得更加悅耳動聽，支援多種波形和自定義配置。

## 效果試聽

傳統進度條音效：單調的嗶嗶聲→
[點我下載原始進度條錄音.wav](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/listen/Original_progress_bar.wav)
悅耳進度條，使用鄭嫌撥和余弦淡入淡出效果→
[點我下載悅耳進度條錄音.wav](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/listen/Pleasant_progress_bar.wav)


## 下載和GitHub倉庫

* 你可以
[點擊這裡下載 V0.21 版本](https://github.com/c469591/Pleasant-Progress-Bar/raw/main/historical_version_addon/pleasant_progress_bar_V0.21.nvda-addon)
的NVDA插件。
* 你還可以前往我的github倉庫頁面
[點我前往悅耳進度條的github倉庫頁面](https://github.com/c469591/Pleasant-Progress-Bar)

## 相容性

理論上支援2019.3之後的所有版本，但僅在nvda2025.2上進行測試。

## 🚀 功能特色

* 多種波形支援：正弦波、方波、三角波、鋸齒波、脈衝波、白噪音
* 智能淡入淡出：余弦和高斯兩種平滑算法
* 自定義配置：音量、頻率範圍完全可調


## ⌨️ 快捷鍵

* NVDA+Shift+P：切換悅耳進度條功能開關

## 🔧 使用方法


1. 安裝插件後重啟NVDA
1. 按 `NVDA+Shift+P` 切換開啟或停用插件功能。（預設為開啟狀態）
1. 在任何有進度條的應用程式中體驗悅耳的音效
1. 透過NVDA設定面板自定義音效參數

### 設定配置

1. 開啟NVDA功能表 → 偏好設定 → 設定
1. 在類別列表中找到「悅耳進度條」
1. 根據個人喜好調整以下設定：
   * 波形類型：選擇喜歡的波形（正弦波最柔和，方波最清脆）
   * 淡入淡出算法：余弦（經典）或高斯（更平滑）
   * 音量調整：0.1最小，到1.0最大
   * 波形長度:從40毫秒到100毫秒，預設值為80毫秒，40毫秒的效果最接近原始進度條的風格，
但80毫秒以下的波形長杜可能會引入啪啪聲，這是32bit音頻系統產生的缺陷，目前還沒找到可以完全修復的方法
   * 起點頻率（低頻）：110Hz到300Hz範圍
   * 終點頻率（高頻）：1200Hz到1750Hz範圍



## 🛠️ 故障排除

### 當進度條音效沒有改變時

1. 檢查插件狀態
   * 按 `NVDA+Shift+P` 確認插件已開啟
   * 聽到「開啟 悅耳進度條」提示即表示功能已啟用
1. 檢查音頻系統
   * 確保你的電腦音頻輸出設備正常工作
   * 嘗試調高系統音量或NVDA音量
   * 在悅耳進度條設定中將音量調高
1. 重置設定
如果音效出現異常，可以在設定面板中：
   * 將所有設定調回預設值
   * 或移除插件重新安裝

### 常見問題解答

Q: 為什麼有時音效會延遲？  
A: 這可能是32位系統的音頻緩衝導致，插件已進行優化，但某些老舊電腦可能仍有輕微延遲。

Q: 可以同時播放多個進度條音效嗎？  
A: 插件設計為單聲道播放，同時多個進度條會以最後觸發的為準，避免音頻混亂。

Q: 音效太大聲或太小聲怎麼辦？  
A: 請到設定面板調整音量，或檢查系統音頻設定。

### 匯出日誌，讓開發者診斷問題

   1. 開啟NVDA功能表 → 偏好 → 設定 → 一般
   1. 將「事件記錄等級」設為「偵錯」
   1. 找到一個有進度條的地方，並確認插件為開啟狀態，
再有進度條的ui等待一段時間，例如30秒，
這樣是為了觸發插件的捕獲邏輯以產生日誌
   1. 開啟NVDA功能表 → 工具 → 檢視事件記錄
   1. 全選複製所有內容並複製，把內容貼到記事本保存，之後把檔按發給開發者來診斷


## 🤝 技術支援

如果你遇到問題或有建議，歡迎聯繫：

* 電子郵件：
c469591@mail.batol.net
* 或前往GitHub倉庫發問提:
[點我前往悅耳進度條的GitHub倉庫](https://github.com/c469591/Pleasant-Progress-Bar)
* 我還有更多原創文章和軟體，可以造訪我的網站→
[小羔羊分享站](https://lamb.tw/)

## 📋 更新日誌

### V0.21

* 對於不支援的系統語言，一律使用英文，其他功能沒有變化

### V0.2


* 設定選項中新增了可控制的波形長度，最短40毫秒，最長100毫秒，40毫秒的效果更接近原始進度條的風格
* 現在用戶也可以在nvda的快速鍵設定中，修改啟用和禁用悅耳進度條的快速鍵


### V0.1

* 首次發布
* 支援多種波形類型
* 音頻緩存系統
* 完整的設定面板
* 余弦和高斯淡入淡出算法


## 📝 授權條款

本插件採用 [GPL v3] 發布，詳細條款請參閱 LICENSE 檔案。

---

享受更悅耳的進度條體驗！ 🎵